"use strict";var DOM=function(){var a={selection:function(a){DOM.selection(this,a)}},b={fps:24},c={mouseup:[],click:[],mousemove:[],mousewheel:[],refresh:[],resize:[]},d=function(a){if(a.touches){var b=a.touches[0];if(a.touch={x:b.pageX,y:b.pageY},a.touches.length>1){var b=a.touches[1];a.touch2={x:b.pageX,y:b.pageY}}}else a.touch={x:a.clientX,y:a.clientY}},e={refresh:function(){for(var a in c.refresh)c.refresh[a]()},click:function(a){d(a);for(var b in c.click)c.click[b](a);return!1},resize:function(a){d(a);for(var b in c.resize)c.resize[b](a);return!1},mousemove:function(a){d(a);for(var b in c.mousemove)c.mousemove[b](a)},mousewheel:function(a){d(a);for(var b in c.mousewheel)c.mousewheel[b](a)},mouseup:function(a){for(var b in c.mouseup)c.mouseup[b](a)}};setInterval(e.refresh,b.fps),window.addEventListener("resize",e.resize),document.addEventListener(/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel",e.mousewheel),"ontouchstart"in window||navigator.maxTouchPoints?(document.addEventListener("touchstart",e.click),document.addEventListener("touchmove",e.mousemove),document.addEventListener("touchend",e.mouseup),document.addEventListener("touchleave",e.mouseup)):(document.addEventListener("mousedown",e.click),document.addEventListener("mousemove",e.mousemove),document.addEventListener("mouseup",e.mouseup),document.addEventListener("mouseout",function(a){null===a.toElement&&null===a.relatedTarget&&e.mouseup(a)}));var f=function(b){for(var c in a)b[c]=a[c];return b};return f.extendDOM=function(b){for(var c in b)a[c]=b[c]},f.extendEVENT=function(a){for(var b in a)switch(b){default:throw b+" is not a known extendEVENT";case"click":c.click.push(a[b]);break;case"mouseup":c.mouseup.push(a[b]);break;case"mousemove":c.mousemove.push(a[b]);break;case"mousewheel":c.mousewheel.push(a[b]);break;case"refresh":c.refresh.push(a[b]);break;case"resize":c.resize.push(a[b])}},f.selection=function(a,b){a=a[0]?a[0]:a,b?(a.style.MozUserSelect="text",a.style.webkitUserSelect="text",a.style.oUserSelect="text",a.style.khtmlUserSelect="text",a.style.msUserSelect="text",a.style.userSelect="text"):(a.style.MozUserSelect="none",a.style.webkitUserSelect="none",a.style.oUserSelect="none",a.style.khtmlUserSelect="none",a.style.msUserSelect="none",a.style.userSelect="none")},f.extend=function(b){if(b===HTMLElement)for(var c in a)b.prototype[c]=a[c];else b.fn&&b.fn.extend&&b.fn.extend(a)},f}();!function(){var a=function(a,c,d,e){var f=[1,0,0,1,0,0],g=performance.now(),h=window.getComputedStyle(a),i=h.transform;if("none"!==i){var j=/\((.*)\)/.exec(i);f=j[1].split(",")}this.matrix=f,this.timeStart=g,this.timeEnd=g,this.speed=d,this.dom=a,this.css={transitionDuration:h.transitionDuration,transitionProperty:h.transitionProperty,transitionDelay:h.transitionDelay},a.style.transition="none";var k=b(a),l=parseInt(a.style.left),m=parseInt(a.style.top);0===k.y&&0===k.x||(a.offsetHeight,0!==k.y&&(a.style.top=m+k.y+"px"),0!==k.x&&(a.style.left=l+k.x+"px")),this.css.left=h.left,this.css.top=h.top,this.transform={start:{x:0,y:0},end:{x:0,y:0}},this.pos={start:{x:l,y:m},end:{x:l,y:m}},this.way=c,this.callback=e,this.refresh=!1},b=function(a){var b=window.getComputedStyle(a),c=0,d=0,e=b.transform;if("none"!==e){var f=/\((.*)\)/,g=f.exec(e),h=g[1].split(",");c=parseInt(h[4]),d=parseInt(h[5])}return{x:c,y:d}},c=function(a){var b=a.getBoundingClientRect(),c=window.getComputedStyle(a),d=parseInt(c.paddingTop,10),e=parseInt(c.paddingBottom,10),f=parseInt(c.paddingLeft,10),g=parseInt(c.paddingRight,10),h=a.clientHeight,i=parseInt(c.marginTop,10),j=parseInt(c.borderTopWidth,10);h+=i+j,h+=parseInt(c.borderBottomWidth,10),h+=parseInt(c.marginBottom,10);var k=a.clientWidth;k+=parseInt(c.marginRight,10),k+=parseInt(c.borderRightWidth,10);var l=parseInt(c.marginLeft,10),m=parseInt(c.borderLeftWidth,10);return k+=m+l,{left:b.left+window.scrollX-l,top:b.top+window.scrollY-i,outer:{height:h,width:k},inner:{height:a.clientHeight-(d+e),width:a.clientWidth-(g+f)}}},d=!1;DOM.extendDOM({move:function(b,c,e){var f=this[0]?this[0]:this;d=new a(f,b,c,e)}}),DOM.extendEVENT({refresh:function(){if(d){var a=d;if(a.refresh){var b=a.refresh.touch,c=0,e=0;switch(a.way){case"-x":c+=(a.mouse.x-b.x)*a.speed;break;case"x":c-=(a.mouse.x-b.x)*a.speed;break;case"-y":e+=(a.mouse.y-b.y)*a.speed;break;case"y":e-=(a.mouse.y-b.y)*a.speed;break;case"xy":c-=(a.mouse.x-b.x)*a.speed,e-=(a.mouse.y-b.y)*a.speed}a.transform.end={y:e,x:c},a.dom.style.transform="matrix("+a.matrix[0]+","+a.matrix[1]+","+a.matrix[2]+","+a.matrix[3]+", "+c+", "+e+")",a.refresh=!1}}},mousemove:function(a){d&&(d.mouse||(d.mouse=a.touch),d.refresh=a)},mouseup:function(a){d&&e.stopDragAndDrop()}});var e={stopDragAndDrop:function(){d.pos.end={x:parseInt(d.css.left)+d.transform.end.x,y:parseInt(d.css.top)+d.transform.end.y},d.timeEnd=performance.now();var a=window.getComputedStyle(d.dom);d.dom.style.transform="matrix("+d.matrix[0]+","+d.matrix[1]+","+d.matrix[2]+","+d.matrix[3]+",0,0)","absolute"!==a.position&&"fixed"!==a.position&&"relative"!==a.position||("auto"===d.css.top&&(d.css.top=c(d.dom).top),"auto"===d.css.left&&(d.css.left=c(d.dom).left),d.dom.style.top=parseInt(d.css.top)+d.transform.end.y+"px",d.dom.style.left=parseInt(d.css.left)+d.transform.end.x+"px");var b=d.timeEnd-d.timeStart,e=Math.abs(d.transform.end.x),f=Math.abs(d.transform.end.y);d.vitesse={x:1/(1*b/e),y:1/(1*b/f)},d.dom.offsetHeight,d.dom.style.transitionDuration=d.css.transitionDuration,d.dom.style.transitionProperty=d.css.transitionProperty,d.dom.style.transitionDelay=d.css.transitionDelay,d.callback(d),d=!1}}}(),function(){var a="_rX",b="_rY",c="data-touchevent",d={x:window.innerWidth,y:window.innerHeight};DOM.extendDOM({resizeEvent:function(d,e){var f=this[0]?this[0]:this,g=function(a,b){if("function"!=typeof b)throw"callback need to be a function";if(f===document.body||!document.body.contains(f))throw"We can't register a event on a dom not in body";if(!f[c]&&(f[c]={}),f[c][a])throw"Event "+a+" is already defined";f[c][a]=b};switch(d){case"x":g("resizeX",e),f.setAttribute(a,!0);break;case"y":g("resizeY",e),f.setAttribute(b,!0);break;case"xy":g("resizeX",e),f.setAttribute(a,!0),g("resizeY",e),f.setAttribute(b,!0)}}}),DOM.extendEVENT({resize:function(e){var f={x:window.innerWidth,y:window.innerHeight};if(f.x!==d.x){d.x=f.x;for(var g=document.querySelectorAll("["+a+"]"),h=0;h<g.length;h++){var i=g[h];i[c]&&"function"==typeof i[c].resizeX&&i[c].resizeX(e)}}if(f.y!==d.y){d.y=f.y;for(var g=document.querySelectorAll("["+b+"]"),h=0;h<g.length;h++){var i=g[h];i[c]&&"function"==typeof i[c].resizeY&&i[c].resizeY(e)}}}})}(),function(){var a="data-touchevent",b=function(b,c){for(;null!==b;){if(b[a]&&"function"==typeof b[a][c])return b;var b=b.parentNode}return!1};DOM.extendDOM({scrollEvent:function(b,c){var d=this[0]?this[0]:this,e=function(b,c){if("function"!=typeof c)throw"callback need to be a function";if(d===document.body||!document.body.contains(d))throw"We can't register a event on a dom not in body";if(!d[a]&&(d[a]={}),d[a][b])throw"Event "+b+" is already defined";d[a][b]=c};switch(b){case"up":e("scrollUp",c);break;case"down":e("scrollDown",c)}}}),DOM.extendEVENT({mousewheel:function(c){if(c.detail<0)var d="scrollUp";else var d="scrollDown";var e=b(c.target,d);if(e){var f={};f.target=e,f.etat=d,e[a][d](f)}}})}(),function(){var a=!1,b=!1,c="data-touchevent",d={timeLongclick:400,timeDbclick:200,debug:!1},e=!1,f=function(b){this.etat="init",this.target=b.target,this.timeStart=performance.now(),this.mouseStart=b.touch,this.mouseEnd=b.touch,this.mouseStart2=!1,this.mouseEnd2=!1,this.vitesse={x:0,y:0},this.origin=b.target,b.touch2&&(e.etat="multitouch"),a&&clearTimeout(a)},g=function(a){d.debug&&console.log(a)},h=function(a,b){for(;null!==a;){if(a[c]&&"function"==typeof a[c][b])return a;var a=a.parentNode}return!1};DOM.extendDOM({touchevent:function(a,d){var e=this[0]?this[0]:this,f=function(a,b){if("function"!=typeof b)throw"callback need to be a function";if(e===document.body||!document.body.contains(e))throw"We can't register a event on a dom not in body";if(!e[c]&&(e[c]={}),e[c][a])throw"Event "+a+" is already defined";e[c][a]=b};switch(a){default:throw a+"is not a known event try touchX or touchY";case"click":f("click",d);break;case"longclick":f("longclick",d);break;case"longclickup":f("longclickup",d);break;case"touchX":f("touchX",d);break;case"touchY":f("touchY",d);break;case"dbclick":f("dbclick",d);break;case"zoom":f("zoom",d);break;case"DEBUG":b=d}}}),DOM.extendEVENT({click:function(b){if(e)switch(e.etat){case"waitclick":i.stopDbClick();break;case"init":b.touch&&(e.etat="multitouch")}else g("init"),e=new f(b),e.timeout&&clearTimeout(e.timeout),a=setTimeout(function(){i.startLongClick()},d.timeLongclick)},mousemove:function(a){if(e)switch(e.etat){case"init":(Math.abs(a.touch.x-e.mouseStart.x)>4||Math.abs(a.clientY-e.mouseStart.y)>4)&&i.stopFindYourWay(a);break;case"multitouch":e.mouseEnd=a.touch,e.mouseEnd2=a.touch2,e.mouseStart2||(e.mouseStart=a.touch,e.mouseStart2=a.touch2,e.d1=Math.sqrt(Math.pow(e.mouseStart.x-e.mouseStart2.x,2)+Math.pow(e.mouseStart.x-e.mouseStart2.x,2))),a.touch&&a.touch2&&i.startZoom();case"zoom":e.mouseEnd=a.touch,e.mouseEnd2=a.touch2,e.mouseStart2||(e.mouseStart=a.touch,e.mouseStart2=a.touch2,e.d1=Math.sqrt(Math.pow(e.mouseStart.x-e.mouseStart2.x,2)+Math.pow(e.mouseStart.x-e.mouseStart2.x,2))),i.sendZoom()}},mouseup:function(b){if(e)switch(e.etat){default:g("event end by mouseup"),e=!1;break;case"multitouch":e=!1;break;case"waitlongclick":i.stopLongClick();break;case"init":var c=h(e.target,"dbclick");c?(g("waitclick"),e.etat="waitclick",a&&clearTimeout(a),a=setTimeout(function(){"waitclick"===e.etat&&i.stopClick()},d.timeDbclick)):i.stopClick()}}});var i={startZoom:function(){if(e&&"multitouch"===e.etat){var a=h(e.target,"zoom");a&&(e.etat="zoom",e.target=a)}},sendZoom:function(){e&&"zoom"===e.etat&&(e.d2=Math.sqrt(Math.pow(e.mouseEnd.x-e.mouseEnd2.x,2)+Math.pow(e.mouseEnd.x-e.mouseEnd2.x,2)),e.target[c].zoom(e))},startLongClick:function(){if(e&&"init"===e.etat){var a=e.target,b=h(e.target,"longclick");b&&(e.etat="waitlongclick",g("waitlongclick"),a[c].longclick(e),e.target=b)}},stopLongClick:function(){if(!e)throw"stopLongClick is call without event";e.etat="longclick",g("longclick");var a=h(e.target,"longclick");a&&a[c].longclickup(e),e=!1},stopClick:function(){if(e){if("init"===e.etat||"waitclick"===e.etat){e.etat="click",g("click");var a=h(e.target,"click");a&&a[c].click(e)}e=!1}},stopDbClick:function(){if(e&&"waitclick"===e.etat){e.etat="dbclick",g("dbclick");var a=h(e.target,"dbclick");a&&a[c].dbclick(e),e=!1}},stopFindYourWay:function(a){if(e&&"init"===e.etat){if(Math.abs(a.touch.x-e.mouseStart.x)>Math.abs(a.touch.y-e.mouseStart.y)){e.etat="moveX",g("moveX");var b=h(a.target,"touchX");b&&b[c].touchX(e)}else{e.etat="moveY",g("moveY");var b=h(a.target,"touchY");b&&b[c].touchY(e)}e=!1}}}}();